import { Meta } from '@storybook/addon-docs/blocks';
import { WrapperUserHasScrolled } from '../stories';

<Meta title="Modules|Hooks/useUserHasScrolled" />

# Overview

`useUserHasScrolled` A hook to detect user scroll intention.

### API

```ts
const userHasScrolled = useUserHasScrolled(options, isListening);
```

### Params

| Property    | Description                      | Type    | Default |
| ----------- | -------------------------------- | ------- | ------- |
| options     | options passed                   | object  | {}      |
| isListening | Add or remove the event listener | boolean | true    |

the `options` parameter is an object that can be extended with any property that will be passed to `triggerFn` when called. Basic options are:

| Property  | Description                                                      | Type                                   | Default |
| --------- | ---------------------------------------------------------------- | -------------------------------------- | ------- |
| target    | the target element that will be used to monitor scroll intention | ref                                    | window  |
| triggerFn | custom trigger function to calculate scroll intention            | function(target, previousPos, options) | -       |

### Usage

```js
import React, { useState, useRef, useEffect } from 'react';
import { createPortal } from 'react-dom';
import styled from 'styled-components';
import { Application, Button } from 'react-rainbow-components';
import { useUserHasScrolled } from '../../src';

const StyledBox = styled.div`
    display: flex;
    position: fixed;
    padding: 1rem 0.75rem 1rem 1rem;
    border-radius: 1rem;
    background-color: white;
    left: calc(50vw - 175px);
    bottom: 1rem;
    width: 350px;
    height: 250px;
    transform: all linear 300ms;
    opacity: 0;
    box-shadow: 1px 2px 5px rgba(0, 0, 0, 0.4);
    ${(props) =>
        props.isVisible &&
        `
        opacity: 1;
        `};

    & > div {
        overflow-y: auto;
    }
`;

const FloatingBox = React.forwardRef((props, ref) => {
    const { isOpen } = props;
    return createPortal(
        <StyledBox ref={ref} isVisible={isOpen}>
            <div>
                <p>
                    Deserunt anim magna do sit id incididunt. Labore sunt aute eiusmod incididunt
                    consequat veniam nostrud ea veniam consequat eu ad. Dolor ea id ad nisi. Mollit
                    in occaecat officia deserunt commodo cillum fugiat consequat. Sint ex mollit
                    aliquip proident labore tempor irure cupidatat.
                </p>
                <p>
                    Ex ullamco ut ipsum ullamco irure dolor. Velit nisi dolor culpa reprehenderit
                    consequat nulla voluptate ut incididunt tempor veniam consectetur consectetur.
                    Consectetur nostrud officia deserunt dolor. Veniam est enim mollit culpa
                    consectetur excepteur est est. Lorem proident ea cillum fugiat deserunt irure.
                    Est do exercitation nisi anim. Elit minim anim non et non amet.
                </p>
            </div>
        </StyledBox>,
        document.body,
    );
});

export default function WrapperUserHasScrolled() {
    const boxRef = useRef();
    const [isOpen, setIsOpen] = useState(false);

    const toggle = () => setIsOpen(!isOpen);

    const label = isOpen ? 'Hide help' : 'Show help';

    const userHasScrolled = useUserHasScrolled({ threshold: 200 }, isOpen);

    const shouldCloseMenu = isOpen && userHasScrolled;

    useEffect(() => {
        if (shouldCloseMenu) {
            setIsOpen(false);
        }
    }, [shouldCloseMenu]);

    return (
        <Application>
            <Button shaded variant="brand" label={label} onClick={toggle} />
            <FloatingBox ref={boxRef} isOpen={isOpen} />
        </Application>
    );
}
```

### Examples

<WrapperUserHasScrolled />
